<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Msgly AI</title>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-purple: #8039DF;
            --dark-purple: #3E0075;
            --glow-purple: #9F4EFF;
            --neon-purple: #7B2CBF;
            --electric-purple: #6A1B9A;
            --light-purple: #F5EDFF;
            --accent-pink: #FF2370;
            --success-green: #10B981;
            --warning-orange: #F59E0B;
            --black: #111827;
            --charcoal: #1F2937;
            --dark-gray: #374151;
            --gray: #6B7280;
            --light-gray: #F9FAFB;
            --white: #FFFFFF;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.15);
            --glow-shadow: 0 0 40px rgba(128, 57, 223, 0.3);
            --intense-glow: 0 0 60px rgba(128, 57, 223, 0.4);
            --neon-glow: 0 0 80px rgba(128, 57, 223, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--light-gray);
            min-height: 100vh;
            display: flex;
        }

        /* Side Navigation */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
            color: var(--white);
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            z-index: 1000;
            overflow-y: auto;
            transition: transform 0.3s ease;
            box-shadow: var(--shadow-lg);
        }

        .sidebar-header {
            padding: 2rem 1.5rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: var(--white);
            margin-bottom: 1rem;
        }

        .sidebar-logo i {
            font-size: 2rem;
            margin-right: 12px;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.3));
        }

        .sidebar-logo-text {
            display: flex;
            flex-direction: column;
        }

        .sidebar-logo-main {
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .sidebar-logo-sub {
            font-size: 0.7rem;
            opacity: 0.8;
            font-weight: 400;
        }

        .sidebar-user {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .sidebar-user-avatar {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .sidebar-user-info {
            flex: 1;
            min-width: 0;
        }

        .sidebar-user-name {
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sidebar-user-email {
            font-size: 0.75rem;
            opacity: 0.8;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sidebar-nav {
            padding: 1.5rem 0;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-section-title {
            padding: 0 1.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
            color: var(--white);
            box-shadow: inset 4px 0 0 var(--white);
        }

        .nav-item i {
            width: 20px;
            margin-right: 12px;
            font-size: 1.1rem;
        }

        .nav-item-text {
            font-size: 0.9rem;
            font-weight: 500;
            flex: 1;
        }

        .coming-soon-badge {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logout-btn {
            width: 100%;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: var(--white);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        /* Mobile Sidebar Toggle */
        .sidebar-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1001;
            background: var(--primary-purple);
            color: var(--white);
            border: none;
            border-radius: 8px;
            padding: 0.75rem;
            cursor: pointer;
            box-shadow: var(--shadow);
        }

        /* Main Content */
        .main-wrapper {
            flex: 1;
            margin-left: 280px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }

        .main-content {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--black);
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: var(--gray);
            font-size: 1.1rem;
        }

        /* Profile Sync Warning */
        .sync-warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.05) 100%);
            border: 2px solid var(--warning-orange);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            display: none;
        }

        .sync-warning-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .sync-warning-icon {
            width: 24px;
            height: 24px;
            color: var(--warning-orange);
            font-size: 1.2rem;
        }

        .sync-warning-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--warning-orange);
        }

        .sync-warning-message {
            color: var(--dark-gray);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .sync-warning-highlight {
            font-weight: 600;
            color: var(--black);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .dashboard-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        /* Card Styles */
        .card {
            background: var(--white);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid rgba(128, 57, 223, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-purple) 0%, var(--electric-purple) 100%);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light-gray);
        }

        .card-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.4rem;
            box-shadow: var(--glow-shadow);
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--black);
        }

        /* Enhanced Account Info Card */
        .account-info-grid {
            display: grid;
            gap: 1.5rem;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: var(--light-gray);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .info-item:hover {
            background: var(--light-purple);
            transform: translateX(4px);
        }

        .info-label {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--dark-gray);
            font-size: 0.9rem;
            font-weight: 600;
        }

        .info-label i {
            color: var(--primary-purple);
            width: 16px;
        }

        .info-value {
            color: var(--black);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .editable-field {
            position: relative;
        }

        .edit-btn {
            background: none;
            border: none;
            color: var(--primary-purple);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            margin-left: 8px;
            transition: all 0.3s ease;
        }

        .edit-btn:hover {
            background: var(--light-purple);
        }

        .edit-input {
            border: 2px solid var(--primary-purple);
            border-radius: 6px;
            padding: 0.5rem;
            font-size: 0.9rem;
            width: 200px;
            font-weight: 600;
        }

        .save-btn, .cancel-btn {
            background: var(--primary-purple);
            color: var(--white);
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 0.5rem;
            transition: all 0.3s ease;
        }

        .cancel-btn {
            background: var(--gray);
        }

        .save-btn:hover {
            background: var(--dark-purple);
        }

        .cancel-btn:hover {
            background: var(--dark-gray);
        }

        /* Enhanced Subscription Card */
        .subscription-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .plan-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--success-green) 0%, #059669 100%);
            color: var(--white);
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: linear-gradient(135deg, var(--success-green) 0%, #059669 100%);
            color: var(--white);
        }

        .status-trial {
            background: linear-gradient(135deg, var(--warning-orange) 0%, #D97706 100%);
            color: var(--white);
        }

        .status-expired {
            background: linear-gradient(135deg, var(--accent-pink) 0%, #DC2626 100%);
            color: var(--white);
        }

        .credits-display {
            display: flex;
            align-items: center;
            gap: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--light-purple) 0%, rgba(128, 57, 223, 0.1) 100%);
            border-radius: 16px;
            margin: 1.5rem 0;
            border: 2px solid rgba(128, 57, 223, 0.2);
        }

        .credits-number {
            font-size: 3rem;
            font-weight: 900;
            color: var(--primary-purple);
            text-shadow: 0 2px 4px rgba(128, 57, 223, 0.2);
        }

        .credits-info {
            flex: 1;
        }

        .credits-text {
            color: var(--dark-gray);
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .credits-details {
            color: var(--gray);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .subscription-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--light-gray);
            border-radius: 12px;
        }

        .detail-label {
            font-size: 0.8rem;
            color: var(--gray);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-size: 1rem;
            color: var(--black);
            font-weight: 700;
        }

        .upgrade-btn {
            width: 100%;
            padding: 1rem 1.5rem;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
            color: var(--white);
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--glow-shadow);
        }

        .upgrade-btn:hover {
            background: linear-gradient(135deg, var(--electric-purple) 0%, var(--primary-purple) 100%);
            transform: translateY(-2px);
            box-shadow: var(--intense-glow);
        }

        /* LinkedIn Profile Card */
        .profile-sync-status {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.05) 100%);
            border: 1px solid var(--warning-orange);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            display: none;
        }

        .profile-sync-status.synced {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border-color: var(--success-green);
        }

        .profile-sync-status.synced .sync-status-indicator i {
            color: var(--success-green);
        }

        .sync-status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .sync-status-indicator i {
            color: var(--warning-orange);
            font-size: 1.1rem;
        }

        .profile-summary {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 2.5rem;
            font-weight: 700;
            box-shadow: var(--glow-shadow);
        }

        .profile-details {
            flex: 1;
        }

        .profile-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--black);
            margin-bottom: 0.5rem;
        }

        .profile-headline {
            color: var(--gray);
            font-size: 1rem;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }

        .profile-company {
            color: var(--dark-gray);
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .profile-location {
            color: var(--gray);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .profile-url {
            background: var(--light-gray);
            padding: 1rem;
            border-radius: 12px;
            margin: 1.5rem 0;
        }

        .profile-url a {
            color: var(--primary-purple);
            text-decoration: none;
            font-size: 0.9rem;
            word-break: break-all;
            font-weight: 500;
        }

        .view-profile-btn {
            width: 100%;
            padding: 1rem;
            background: var(--light-gray);
            border: 1px solid rgba(128, 57, 223, 0.2);
            border-radius: 12px;
            color: var(--gray);
            font-size: 0.95rem;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Analytics Card */
        .coming-soon {
            text-align: center;
            padding: 3rem;
            color: var(--gray);
        }

        .coming-soon i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            color: var(--primary-purple);
            opacity: 0.6;
        }

        .coming-soon h3 {
            font-size: 1.4rem;
            margin-bottom: 0.75rem;
            color: var(--dark-gray);
        }

        .coming-soon p {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Loading State */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            flex-direction: column;
            gap: 1.5rem;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--light-gray);
            border-top: 4px solid var(--primary-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error State */
        .error {
            text-align: center;
            padding: 3rem;
            color: var(--accent-pink);
        }

        .error i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
        }

        /* Authentication Warning */
        .auth-warning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .auth-warning-content {
            background: var(--white);
            padding: 2rem;
            border-radius: 16px;
            text-align: center;
            max-width: 400px;
            box-shadow: var(--shadow-lg);
        }

        .auth-warning-icon {
            width: 60px;
            height: 60px;
            background: var(--warning-orange);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
            color: var(--white);
        }

        .auth-warning-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--black);
        }

        .auth-warning-message {
            color: var(--gray);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .auth-warning-btn {
            padding: 0.75rem 1.5rem;
            background: var(--primary-purple);
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auth-warning-btn:hover {
            background: var(--dark-purple);
        }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .dashboard-row {
                grid-template-columns: 1fr;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .sidebar-toggle {
                display: block;
            }

            .main-wrapper {
                margin-left: 0;
            }

            .main-content {
                padding: 1rem;
                margin-top: 4rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .card {
                padding: 1.5rem;
            }

            .profile-summary {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .profile-avatar {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }

            .sync-warning {
                padding: 1rem;
            }

            .subscription-details {
                grid-template-columns: 1fr;
            }

            .credits-display {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Authentication Warning (shows while checking auth) -->
    <div class="auth-warning" id="authWarning" style="display: none;">
        <div class="auth-warning-content">
            <div class="auth-warning-icon">
                <i class="fas fa-lock"></i>
            </div>
            <h3 class="auth-warning-title">Authentication Required</h3>
            <p class="auth-warning-message">You need to sign in to access your dashboard.</p>
            <button class="auth-warning-btn" onclick="redirectToLogin()">
                Go to Login
            </button>
        </div>
    </div>

    <!-- Mobile Sidebar Toggle -->
    <button class="sidebar-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Side Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="/dashboard" class="sidebar-logo">
                <i class="fas fa-comments"></i>
                <div class="sidebar-logo-text">
                    <div class="sidebar-logo-main">Msgly.AI</div>
                    <div class="sidebar-logo-sub">By Chopa AI LTD</div>
                </div>
            </a>
            
            <div class="sidebar-user">
                <div class="sidebar-user-avatar" id="sidebarUserAvatar">??</div>
                <div class="sidebar-user-info">
                    <div class="sidebar-user-name" id="sidebarUserName">Loading...</div>
                    <div class="sidebar-user-email" id="sidebarUserEmail">Loading...</div>
                </div>
            </div>
        </div>

        <div class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Main Menu</div>
                <a href="#" class="nav-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="nav-item-text">Dashboard</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('messages')">
                    <i class="fas fa-envelope"></i>
                    <span class="nav-item-text">Messages</span>
                    <span class="coming-soon-badge">Soon</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('analytics')">
                    <i class="fas fa-chart-line"></i>
                    <span class="nav-item-text">Analytics</span>
                    <span class="coming-soon-badge">Soon</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('target-profile')">
                    <i class="fas fa-crosshairs"></i>
                    <span class="nav-item-text">Target Profile</span>
                    <span class="coming-soon-badge">Soon</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('linkedin-profile')">
                    <i class="fab fa-linkedin"></i>
                    <span class="nav-item-text">LinkedIn Profile</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Account</div>
                <a href="#" class="nav-item" onclick="showSection('profile')">
                    <i class="fas fa-user-circle"></i>
                    <span class="nav-item-text">Profile</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('billing')">
                    <i class="fas fa-credit-card"></i>
                    <span class="nav-item-text">Billing</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i>
                    <span class="nav-item-text">Settings</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Support</div>
                <a href="#" class="nav-item" onclick="showSection('help')">
                    <i class="fas fa-question-circle"></i>
                    <span class="nav-item-text">Help Center</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('feedback')">
                    <i class="fas fa-comment-alt"></i>
                    <span class="nav-item-text">Feedback</span>
                </a>
            </div>
        </div>

        <div class="sidebar-footer">
            <a href="#" class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </a>
        </div>
    </nav>

    <!-- Main Content Wrapper -->
    <div class="main-wrapper">
        <main class="main-content">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">Dashboard</h1>
                <p class="page-subtitle">Welcome to your AI-powered LinkedIn messaging center</p>
            </div>

            <!-- Profile Sync Warning -->
            <div class="sync-warning" id="syncWarning">
                <div class="sync-warning-header">
                    <i class="fas fa-exclamation-triangle sync-warning-icon"></i>
                    <div class="sync-warning-title">Your profile is not fully synced yet.</div>
                </div>
                <div class="sync-warning-message">
                    To personalize your outreach messages at the highest level, we first need a complete view of your LinkedIn profile. Please visit <span class="sync-warning-highlight">your own LinkedIn profile</span> with the Msgly.AI Chrome extension installed and active – this will automatically sync your data. Once completed, you'll unlock the full power of our AI-generated messages.
                </div>
            </div>

            <!-- Loading State -->
            <div class="loading" id="loadingState">
                <div class="spinner"></div>
                <p>Loading your dashboard...</p>
            </div>

            <!-- Error State -->
            <div class="error" id="errorState" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>Unable to load dashboard</h3>
                <p id="errorMessage">Please try refreshing the page or logging in again.</p>
            </div>

            <!-- Dashboard Content -->
            <div id="dashboardContent" style="display: none;">
                <!-- Top Row: Account Info and Subscription -->
                <div class="dashboard-row">
                    <!-- Enhanced Account Information -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <h3 class="card-title">Account Information</h3>
                        </div>
                        
                        <div class="account-info-grid">
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-user"></i>
                                    Full Name
                                </div>
                                <div class="info-value editable-field">
                                    <span id="accountFullName">Loading...</span>
                                    <button class="edit-btn" onclick="editField('fullName')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-envelope"></i>
                                    Email Address
                                </div>
                                <div class="info-value" id="accountEmail">Loading...</div>
                            </div>
                            
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-phone"></i>
                                    Phone Number
                                </div>
                                <div class="info-value editable-field">
                                    <span id="accountPhone">Not provided</span>
                                    <button class="edit-btn" onclick="editField('phone')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-map-marker-alt"></i>
                                    Address
                                </div>
                                <div class="info-value editable-field">
                                    <span id="accountAddress">Not provided</span>
                                    <button class="edit-btn" onclick="editField('address')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-calendar-plus"></i>
                                    Member Since
                                </div>
                                <div class="info-value" id="accountSignupDate">Loading...</div>
                            </div>
                            
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-id-badge"></i>
                                    User ID
                                </div>
                                <div class="info-value" id="accountUserId">Loading...</div>
                            </div>
                            
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-clock"></i>
                                    Time Zone
                                </div>
                                <div class="info-value editable-field">
                                    <span id="accountTimezone">Auto-detected</span>
                                    <button class="edit-btn" onclick="editField('timezone')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="info-item">
                                <div class="info-label">
                                    <i class="fas fa-shield-alt"></i>
                                    Account Type
                                </div>
                                <div class="info-value" id="accountType">Standard User</div>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Subscription & Credits -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-crown"></i>
                            </div>
                            <h3 class="card-title">Subscription & Credits</h3>
                        </div>
                        
                        <div class="subscription-header">
                            <div class="plan-badge" id="planBadge">
                                <i class="fas fa-star"></i>
                                <span id="currentPlan">Loading...</span>
                            </div>
                            <div class="status-badge status-active" id="statusBadge">
                                <i class="fas fa-check-circle"></i>
                                <span id="subscriptionStatus">Active</span>
                            </div>
                        </div>
                        
                        <div class="credits-display">
                            <div class="credits-number" id="creditsRemaining">--</div>
                            <div class="credits-info">
                                <div class="credits-text">Credits Remaining</div>
                                <div class="credits-details" id="creditsDetails">
                                    Used this month: <span id="creditsUsed">0</span><br>
                                    <span id="renewalInfo">Refreshes monthly</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="subscription-details">
                            <div class="detail-item">
                                <div class="detail-label">Billing Model</div>
                                <div class="detail-value" id="billingModel">Monthly</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Next Renewal</div>
                                <div class="detail-value" id="nextRenewal">N/A</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Messages Sent</div>
                                <div class="detail-value" id="messagesSent">0</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Success Rate</div>
                                <div class="detail-value" id="successRate">N/A</div>
                            </div>
                        </div>
                        
                        <button class="upgrade-btn" onclick="upgradeAccount()">
                            <i class="fas fa-rocket"></i>
                            Upgrade Plan / Buy Credits
                        </button>
                    </div>
                </div>

                <!-- Bottom Row: LinkedIn Profile and Analytics -->
                <div class="dashboard-row">
                    <!-- LinkedIn Profile Summary -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fab fa-linkedin"></i>
                            </div>
                            <h3 class="card-title">LinkedIn Profile Summary</h3>
                        </div>
                        
                        <!-- Profile Sync Status -->
                        <div class="profile-sync-status" id="profileSyncStatus">
                            <div class="sync-status-indicator">
                                <i class="fas fa-exclamation-circle" id="syncStatusIcon"></i>
                                <span id="syncStatusText">Profile sync pending...</span>
                            </div>
                        </div>
                        
                        <div class="profile-summary">
                            <div class="profile-avatar" id="profileAvatar">
                                <span id="profileInitials">--</span>
                            </div>
                            <div class="profile-details">
                                <div class="profile-name" id="profileFullName">Loading...</div>
                                <div class="profile-headline" id="profileHeadline">Loading...</div>
                                <div class="profile-company" id="profileCompany">Loading...</div>
                                <div class="profile-location" id="profileLocation">
                                    <i class="fas fa-map-marker-alt"></i>
                                    Loading...
                                </div>
                            </div>
                        </div>
                        
                        <div class="profile-url">
                            <a href="#" id="profileUrl" target="_blank">Loading...</a>
                        </div>
                        
                        <button class="view-profile-btn" id="viewProfileBtn">
                            <i class="fas fa-sync-alt"></i>
                            <span id="profileBtnText">Sync your LinkedIn profile first</span>
                        </button>
                    </div>

                    <!-- Analytics -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3 class="card-title">Analytics & Performance</h3>
                        </div>
                        
                        <div class="coming-soon">
                            <i class="fas fa-chart-bar"></i>
                            <h3>Analytics Dashboard – Coming Soon</h3>
                            <p>Track your reply rates, message performance, recent recipients, conversion metrics, and comprehensive analytics data coming soon!</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Global variables
        let currentUserData = null;

        // ✅ SMART AUTHENTICATION: Check auth on page load and redirect to login if needed
        document.addEventListener('DOMContentLoaded', function() {
            initializeTimezone();
            checkAuthentication();
        });

        function initializeTimezone() {
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            document.getElementById('accountTimezone').textContent = timezone;
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }

        function showSection(section) {
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.nav-item').classList.add('active');

            // Handle different sections
            switch(section) {
                case 'dashboard':
                    // Already on dashboard
                    break;
                case 'messages':
                    alert('💬 Messages Center - Coming Soon!\n\nTrack your sent messages, manage conversations, and monitor response rates.');
                    break;
                case 'analytics':
                    alert('📊 Analytics Dashboard - Coming Soon!\n\nView detailed performance metrics, success rates, and engagement insights.');
                    break;
                case 'target-profile':
                    alert('🎯 Target Profile Manager - Coming Soon!\n\nSave and organize profiles you want to reach out to.');
                    break;
                case 'linkedin-profile':
                    alert('👤 LinkedIn Profile Manager - Coming Soon!\n\nManage your LinkedIn profile data and sync settings.');
                    break;
                case 'profile':
                    alert('⚙️ Profile Settings - Coming Soon!\n\nUpdate your account settings and preferences.');
                    break;
                case 'billing':
                    alert('💳 Billing Management - Coming Soon!\n\nManage your subscription, payment methods, and billing history.');
                    break;
                case 'settings':
                    alert('🔧 Account Settings - Coming Soon!\n\nCustomize your experience and manage privacy settings.');
                    break;
                case 'help':
                    alert('❓ Help Center - Coming Soon!\n\nAccess tutorials, FAQs, and support documentation.');
                    break;
                case 'feedback':
                    alert('💭 Feedback Portal - Coming Soon!\n\nShare your thoughts and help us improve Msgly.AI!');
                    break;
                default:
                    alert(`${section.charAt(0).toUpperCase() + section.slice(1)} section coming soon!`);
            }
        }

        // ✅ FIXED: Smart authentication check - redirect to LOGIN if no auth
        async function checkAuthentication() {
            const token = getAuthToken();
            
            if (!token) {
                console.log('❌ No authentication token found - redirecting to login');
                redirectToLogin();
                return;
            }

            try {
                await loadDashboardData(token);
            } catch (error) {
                console.error('Dashboard load error:', error);
                
                if (error.message.includes('401') || error.message.includes('403')) {
                    console.log('❌ Token invalid - redirecting to login');
                    redirectToLogin();
                } else {
                    showError('Failed to load dashboard data. Please try logging in again.');
                }
            }
        }

        function getAuthToken() {
            // Check URL params first (from OAuth callback)
            const urlParams = new URLSearchParams(window.location.search);
            const urlToken = urlParams.get('token');
            
            if (urlToken) {
                localStorage.setItem('authToken', urlToken);
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
                return urlToken;
            }
            
            // Check localStorage
            return localStorage.getItem('authToken');
        }

        // ✅ FIXED: Redirect to LOGIN page (not sign-up)
        function redirectToLogin() {
            console.log('🔒 Redirecting to login page...');
            
            // Show auth warning first
            document.getElementById('authWarning').style.display = 'flex';
            
            // Redirect after 2 seconds
            setTimeout(() => {
                window.location.href = '/login';
            }, 2000);
        }

        // ✅ Added explicit redirect function for auth warning button
        function redirectToLoginNow() {
            window.location.href = '/login';
        }

        async function loadDashboardData(token) {
            try {
                const response = await fetch('https://api.msgly.ai/profile', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    if (response.status === 401 || response.status === 403) {
                        localStorage.removeItem('authToken');
                        throw new Error(`Authentication failed: ${response.status}`);
                    }
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Failed to load profile data');
                }

                currentUserData = data.data;
                populateDashboard(data.data);
                
            } catch (error) {
                console.error('API Error:', error);
                throw error; // Re-throw for checkAuthentication to handle
            }
        }

        function populateDashboard(data) {
            const { user, profile, syncStatus } = data;

            // Update sidebar user info
            document.getElementById('sidebarUserName').textContent = user.displayName || user.email;
            document.getElementById('sidebarUserEmail').textContent = user.email;
            const sidebarInitials = getInitials(user.displayName || user.email);
            document.getElementById('sidebarUserAvatar').textContent = sidebarInitials;

            // ✅ FIXED: Show/hide sync warning based on registration_completed + sync status
            const syncWarning = document.getElementById('syncWarning');
            
            // Check if registration is complete AND profile is synced
            const isRegistrationComplete = user.registrationCompleted;  // ✅ FIXED: Changed from profileCompleted
            const isProfileSynced = !syncStatus?.isIncomplete;
            
            if (!isRegistrationComplete || !isProfileSynced) {
                syncWarning.style.display = 'block';
                
                // Update warning message based on what's incomplete
                const warningMessage = syncWarning.querySelector('.sync-warning-message');
                if (!isRegistrationComplete) {
                    warningMessage.innerHTML = `
                        <span class="sync-warning-highlight">Your registration is not complete yet.</span>
                        Please complete your LinkedIn profile setup by providing your LinkedIn URL and accepting our terms.
                    `;
                } else if (!isProfileSynced) {
                    warningMessage.innerHTML = `
                        To personalize your outreach messages at the highest level, we first need a complete view of your LinkedIn profile. 
                        Please visit <span class="sync-warning-highlight">your own LinkedIn profile</span> with the Msgly.AI Chrome extension installed and active – this will automatically sync your data. Once completed, you'll unlock the full power of our AI-generated messages.
                    `;
                }
            } else {
                syncWarning.style.display = 'none';
            }

            // Enhanced Account Information
            document.getElementById('accountFullName').textContent = user.displayName || 'Not provided';
            document.getElementById('accountEmail').textContent = user.email;
            document.getElementById('accountSignupDate').textContent = formatDate(user.createdAt);
            document.getElementById('accountUserId').textContent = `#${user.id}`;
            
            // These would come from expanded user data - for now showing placeholders
            document.getElementById('accountPhone').textContent = user.phone || 'Not provided';
            document.getElementById('accountAddress').textContent = user.address || 'Not provided';

            // Enhanced Subscription & Credits
            const planName = (user.packageType || 'free').charAt(0).toUpperCase() + (user.packageType || 'free').slice(1);
            document.getElementById('currentPlan').textContent = `${planName} Plan`;
            document.getElementById('creditsRemaining').textContent = user.credits || 0;
            
            // Update plan badge color based on plan
            const planBadge = document.getElementById('planBadge');
            if (user.packageType === 'free') {
                planBadge.style.background = 'linear-gradient(135deg, var(--success-green) 0%, #059669 100%)';
            } else if (user.packageType === 'silver') {
                planBadge.style.background = 'linear-gradient(135deg, #6B7280 0%, #4B5563 100%)';
            } else if (user.packageType === 'gold') {
                planBadge.style.background = 'linear-gradient(135deg, #F59E0B 0%, #D97706 100%)';
            } else if (user.packageType === 'platinum') {
                planBadge.style.background = 'linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%)';
            }

            // Subscription status
            const status = user.subscriptionStatus || 'active';
            document.getElementById('subscriptionStatus').textContent = status.charAt(0).toUpperCase() + status.slice(1);
            
            const statusBadge = document.getElementById('statusBadge');
            statusBadge.className = `status-badge status-${status}`;

            // Billing details
            document.getElementById('billingModel').textContent = (user.billingModel || 'monthly').charAt(0).toUpperCase() + (user.billingModel || 'monthly').slice(1);
            
            // Calculate next renewal (placeholder logic)
            const nextRenewal = new Date();
            nextRenewal.setMonth(nextRenewal.getMonth() + 1);
            document.getElementById('nextRenewal').textContent = user.packageType === 'free' ? 'N/A' : formatDate(nextRenewal.toISOString());

            // Placeholder analytics data
            document.getElementById('messagesSent').textContent = '0'; // Would come from message logs
            document.getElementById('successRate').textContent = 'N/A'; // Would be calculated
            document.getElementById('creditsUsed').textContent = '0'; // Would be calculated

            // Renewal info
            const renewalInfo = document.getElementById('renewalInfo');
            if (user.packageType === 'free') {
                renewalInfo.textContent = 'Refreshes monthly • Forever free';
            } else {
                renewalInfo.textContent = `Next renewal: ${formatDate(nextRenewal.toISOString())}`;
            }

            // LinkedIn Profile Summary
            if (profile) {
                // ✅ FIXED: Check if profile is properly synced AND registration is complete
                const isProfileSynced = profile.fullName && profile.headline && (profile.currentCompanyName || profile.currentCompany);
                const isRegistrationComplete = user.registrationCompleted;  // ✅ FIXED: Changed from profileCompleted
                
                // Update sync status
                const syncStatus = document.getElementById('profileSyncStatus');
                const syncStatusIcon = document.getElementById('syncStatusIcon');
                const syncStatusText = document.getElementById('syncStatusText');
                const profileBtn = document.getElementById('viewProfileBtn');
                const profileBtnText = document.getElementById('profileBtnText');
                
                if (isRegistrationComplete && isProfileSynced) {
                    syncStatus.classList.add('synced');
                    syncStatusIcon.className = 'fas fa-check-circle';
                    syncStatusText.textContent = '✨ Profile synced and ready to rock!';
                    profileBtn.classList.remove('view-profile-btn');
                    profileBtn.classList.add('upgrade-btn');
                    profileBtn.style.opacity = '1';
                    profileBtn.style.cursor = 'pointer';
                    profileBtnText.innerHTML = '<i class="fas fa-eye"></i> View Full Profile';
                } else {
                    syncStatus.style.display = 'block';
                    if (!isRegistrationComplete) {
                        syncStatusText.textContent = '⚠️ Complete your registration first by providing your LinkedIn URL';
                    } else {
                        syncStatusText.textContent = '🔄 LinkedIn magic pending - sync your profile to unlock full power!';
                    }
                    profileBtnText.innerHTML = '<i class="fas fa-sync-alt"></i> Complete registration and sync profile';
                }
                
                // Display profile information
                document.getElementById('profileFullName').textContent = profile.fullName || 'Profile name not synced yet';
                document.getElementById('profileHeadline').textContent = profile.headline || 'Professional headline awaiting sync...';
                
                // Use current_company_name if available, fallback to current_company
                const companyName = profile.currentCompanyName || profile.currentCompany || 'Company info pending sync...';
                document.getElementById('profileCompany').textContent = companyName;
                
                const locationElement = document.getElementById('profileLocation');
                locationElement.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${profile.location || 'Location awaiting sync...'}`;
                
                const profileUrlElement = document.getElementById('profileUrl');
                if (profile.linkedinUrl) {
                    profileUrlElement.href = profile.linkedinUrl;
                    profileUrlElement.textContent = profile.linkedinUrl;
                } else {
                    profileUrlElement.textContent = 'LinkedIn URL will appear after registration';
                    profileUrlElement.removeAttribute('href');
                }

                // Set profile initials
                const initials = getInitials(profile.fullName || user.displayName || user.email);
                document.getElementById('profileInitials').textContent = initials;
            } else {
                // No LinkedIn profile data at all
                const syncStatus = document.getElementById('profileSyncStatus');
                const syncStatusText = document.getElementById('syncStatusText');
                const isRegistrationComplete = user.registrationCompleted;  // ✅ FIXED: Changed from profileCompleted
                
                syncStatus.style.display = 'block';
                if (!isRegistrationComplete) {
                    syncStatusText.textContent = '⚠️ Complete your registration first by providing your LinkedIn URL';
                } else {
                    syncStatusText.textContent = '🚀 Ready to supercharge your outreach? Sync your LinkedIn profile now!';
                }
                
                document.getElementById('profileFullName').textContent = 'LinkedIn profile not connected yet';
                document.getElementById('profileHeadline').textContent = 'Connect your profile to see your headline here';
                document.getElementById('profileCompany').textContent = 'Your company info will appear after sync';
                document.getElementById('profileLocation').innerHTML = '<i class="fas fa-map-marker-alt"></i> Location will sync automatically';
                document.getElementById('profileUrl').textContent = 'LinkedIn URL will appear after connection';
                
                const initials = getInitials(user.displayName || user.email);
                document.getElementById('profileInitials').textContent = initials;
            }

            // Show dashboard content
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('dashboardContent').style.display = 'block';
        }

        function showError(message) {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorState').style.display = 'block';
        }

        function formatDate(dateString) {
            if (!dateString) return 'Not available';
            
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            } catch (error) {
                return 'Invalid date';
            }
        }

        function getInitials(name) {
            if (!name) return '??';
            
            const parts = name.split(' ');
            if (parts.length >= 2) {
                return (parts[0][0] + parts[1][0]).toUpperCase();
            } else {
                return name.substring(0, 2).toUpperCase();
            }
        }

        // Editable field functionality
        function editField(fieldName) {
            const spanElement = document.getElementById(`account${fieldName.charAt(0).toUpperCase() + fieldName.slice(1)}`);
            const currentValue = spanElement.textContent;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentValue === 'Not provided' ? '' : currentValue;
            input.className = 'edit-input';
            
            const saveBtn = document.createElement('button');
            saveBtn.textContent = 'Save';
            saveBtn.className = 'save-btn';
            saveBtn.onclick = () => saveField(fieldName, input.value);
            
            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = 'Cancel';
            cancelBtn.className = 'cancel-btn';
            cancelBtn.onclick = () => cancelEdit(fieldName);
            
            spanElement.style.display = 'none';
            spanElement.parentNode.querySelector('.edit-btn').style.display = 'none';
            
            spanElement.parentNode.appendChild(input);
            spanElement.parentNode.appendChild(saveBtn);
            spanElement.parentNode.appendChild(cancelBtn);
            
            input.focus();
        }

        async function saveField(fieldName, value) {
            const token = getAuthToken();
            
            try {
                // This would be a real API call to update user data
                const response = await fetch('https://api.msgly.ai/update-user-info', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        [fieldName]: value
                    })
                });

                if (response.ok) {
                    // Update the display
                    const spanElement = document.getElementById(`account${fieldName.charAt(0).toUpperCase() + fieldName.slice(1)}`);
                    spanElement.textContent = value || 'Not provided';
                    cancelEdit(fieldName);
                    
                    // Show success message
                    alert('Information updated successfully!');
                } else {
                    throw new Error('Failed to update information');
                }
            } catch (error) {
                console.error('Update error:', error);
                alert('Failed to update information. Please try again.');
                cancelEdit(fieldName);
            }
        }

        function cancelEdit(fieldName) {
            const container = document.getElementById(`account${fieldName.charAt(0).toUpperCase() + fieldName.slice(1)}`).parentNode;
            const input = container.querySelector('.edit-input');
            const saveBtn = container.querySelector('.save-btn');
            const cancelBtn = container.querySelector('.cancel-btn');
            const spanElement = container.querySelector('span');
            const editBtn = container.querySelector('.edit-btn');
            
            if (input) input.remove();
            if (saveBtn) saveBtn.remove();
            if (cancelBtn) cancelBtn.remove();
            
            spanElement.style.display = 'inline';
            editBtn.style.display = 'inline';
        }

        function upgradeAccount() {
            alert('Upgrade functionality coming soon! Premium plans will be available shortly.');
        }

        function logout() {
            localStorage.removeItem('authToken');
            window.location.href = '/login';
        }

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.querySelector('.sidebar-toggle');
            
            if (window.innerWidth <= 768 && 
                !sidebar.contains(event.target) && 
                !toggle.contains(event.target) && 
                sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
        });
    </script>
</body>
</html>
